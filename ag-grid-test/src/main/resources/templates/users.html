<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Spring Boot + ag-Grid (Balham Theme)</title>

    <!-- âœ… Balham í…Œë§ˆ ìŠ¤íƒ€ì¼ ì ìš© -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community@33.0.4/styles/ag-grid.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community@33.0.4/styles/ag-theme-balham.css">

    <!-- ag-Grid ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdn.jsdelivr.net/npm/ag-grid-community@33.0.4/dist/ag-grid-community.min.js"></script>
</head>
<body>
    <h2>Spring Boot + ag-Grid (Balham Theme)</h2>

    <!-- âœ… í…Œë§ˆë¥¼ balhamìœ¼ë¡œ ë³€ê²½ -->
    <div id="myGrid" class="ag-theme-balham" style="width: 600px; height: 400px;"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // âœ… ì´ˆê¸° ë°ì´í„° (API ìš”ì²­ ì „)
            var rowData = [
                { make: "Tesla", model: "Model Y", price: 64950, electric: true },
                { make: "Ford", model: "F-Series", price: 33850, electric: false },
                { make: "Toyota", model: "Corolla", price: 29600, electric: false }
            ];

            // âœ… ag-Grid ì„¤ì •
            const gridOptions = {
                columnDefs: [
                    { headerName: "ì œì¡°ì‚¬", field: "make", sortable: true, filter: true },
                    { headerName: "ëª¨ë¸", field: "model", sortable: true, filter: true },
                    { headerName: "ê°€ê²©($)", field: "price", sortable: true, filter: true },
                    { headerName: "ì „ê¸°ì°¨ ì—¬ë¶€", field: "electric", sortable: true, filter: true }
                ],
                rowData: rowData, // âœ… ì´ˆê¸° ë°ì´í„° ì„¤ì •
                pagination: true,
                theme: "legacy",
                onGridReady: function (params) {
                    console.log("âœ… Grid Ready! API Initialized.");
                    gridOptions.api = params.api;

                    fetch('/api/users')
                    .then(response => response.json())
                    .then(data => {
                        console.log("ğŸ“Œ APIì—ì„œ ë°›ì€ ë°ì´í„°:", data);

                        // âœ… ê¸°ì¡´ ë°ì´í„° ì‚­ì œ í›„ ìƒˆë¡œìš´ ë°ì´í„° ì¶”ê°€
                        if (gridOptions.api) {
                            const allRows = []; // âœ… ë³€ìˆ˜ ì •ì˜ ì¶”ê°€
                            gridOptions.api.forEachNode(node => allRows.push(node.data)); // ëª¨ë“  í–‰ ê°€ì ¸ì˜¤ê¸°
                            if (allRows.length > 0) {
                                gridOptions.api.applyTransaction({ remove: allRows }); // ê¸°ì¡´ ë°ì´í„° ì‚­ì œ
                            }
                            gridOptions.api.applyTransaction({ add: data }); // ìƒˆë¡œìš´ ë°ì´í„° ì¶”ê°€
                        } else {
                            console.error("ğŸš¨ Grid APIê°€ ì•„ì§ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
                        }
                    })
                    .catch(error => console.error("ğŸš¨ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:", error));
                }
            };

            // âœ… ag-Grid ì´ˆê¸°í™”
            const gridDiv = document.querySelector("#myGrid");
            agGrid.createGrid(gridDiv, gridOptions);
        });
    </script>
</body>
</html>
